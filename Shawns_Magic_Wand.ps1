$Wizard =@"  
            

.--''''''''''''''''''''''''-vBQl'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
y=oy_.''''''''''''''''''''.,v9\;'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
@Qkv5v-'''''''''''''-.'..^9BV..n^,''''''.''''''''''''''''''''''''''''''''''''''''''''''''''''''
@B8BeaQL.'''''''''.;eBQY-^s<..;DQm-'.Ys8,.''.''''''''''''''''''''''''''''''''''''''''''''''''''
g@09Q85QZ='''''''''.rI^r,,uzd..=_''-)Q@BY._D0*'''''''''''''''''''''''''''''''''''''''''''''''''
r@BRODBQVVr.'''''''''''''=@@E;.'''''..]='',@@|'''''''''''''''''''''''''''''''''''''''''''''''''
=G@8ONNgBZ=..'''''''''''';xO_''''''''''''',@@|'''''''''''''''''''''''''''''''''''''''''''''''''
0r@B6OONDBBr.''''''''''''''''''''''''''''',@@l'''''''''''''''''''''''''''''''''''''''''''''''''
8ZK@0NONNNg@0,..'''''''''''''''''''''''''',@@V'''''''''''''''''''''''''''''''''''''''''''''''''
,0^0B9OOOONDBB*...''''''''''''''''''''''''=@@o..'''''''''''''''''''''''''''''''''''''''''''''''
.-,=@QNOOOOONg@9,=*''''''''''''''''''''',=KBdIVn=''''''''''''''''''''''''''''''''''''''''''''''
'''.p@0NNONE0g0BRL9.'''''''''''''''''''_RE0YL^^(g;..'''''''''''''''''''''''''''''''''''''''''''
''''<@B6g0Mjl)^*Z=Z,''''''''''''''''''..^)Be]\^<ZP.''''''''''''''''''''''''''''''''''''''''''''
''...Z@9urcuuvcj3Y*,'''''''''''''''.,y3h)m8EKnVxBx..'''''''''''''''''''''''''''''''''''''''''''
.>r_rD)Ly^lR|xyByq.''''''''''''''._\YKQ@gxvGMEBBp,v.'''''''''''''''''''''''''''''''''''''''''''
,8..BrcV^^*YlY^^)Gyr].'''''''''.,**yD9QB^<^lB@p*kn.''''''''''''''''''''''''''''''''''''''''''''
x8.=B\cyllur=>KapZL\*.'''''''''.=rdENNg@n*wBBvkZr.'''''''...'''''''..'.-,-.>^...,.'._=-''''''''
p^_Md-,._=.._xV<;U-.=,..'.....-v686NONDBQBBBB^d-''''''''.xy*,,^xyXtzwwkyknL)x\xVwypZdZUIY,'..=-
,VB@@Vn-_,,'',..^D9kKZRKYr=_xOBQ6N55OO6B@Q0QB==.''''''''.q_NDDdV^===========vu5Ow)======*XpXv=(
^xY8EwByQfY..x;,BBB69D08DadQB06Odk==Y5O8@Q0QB,.'''''''''.\,@r,*laPml*==========;xLYv;======*V3U
l3QQB80@Q@ZP=|v)BB8OONU^vn6ONNOOMrl*yNNE@B0B9.'''''''''''.^@(,=vr=,;YVVycr=========*LYL|=======
QgNNNON90@BBQ@)=gBgO6OI>^yNNNiPOMONNONN6BBgBG.'''''''''''.lB=,BBQQ89ov=,^lyVl^========;v]lVM080
9OOOOOOODBEQ@QB<QBBgQ6ddNOOMx._^VdOOOOOOQBg@o.'''''''''''.p0,)BENZGZgQBEmx=,<YYL*==(YVllL\wPxr;
ONOOOOOOOOO606BBBREBDdgD9NOO=lkYZONOONN6D@B@r.'''''''''''.BK,zQ3)xlYYwN6DQBQ6k;,rBZx*=====vpYjU
OOOOOOOOOOOOOOg@0OOB6_<YwH6gBBBBBBBBBBBgbM3y>\'''''''''''.@c,M8vdNOOOOOOOOONRgQvv@n===^\cwjPu)=
OOOOOOOOOOOOONNRNOOQ@v..''..--------...-;LwaV_'''''''''''.@Y,RgbNOOOOOOOOOOONN8HY@r==gQMr======
omN9NNONOOOOOOONOOOR@Q-.'''''''''''''''''''''''''''''''''.@l,d8NOOOOOOOOOOOOON8ZV@;==8^)VIaGjL;
<h9BQNOOOOOOOOOOOONOQ@c.'''''''''''''''''''''''''''''''.v_@L,VQ6OOOOOOOOOOOOONQpsB===B*=;==<nHE
NOg@B6ONOOOOOMc,rxqORB@_'''''''''''''''''''''''''''..,;|b,By,,M006ONONOOOOOON6Bld6===BL=)nIhl<*
ONB@@ROOOOOOOZ^.<vZOOQ@\'''''''''''''''''''''''''''-=rYwlmB0zi;=iH00NOOOOOOOORB=8H===Bu=rYlr;==
9QBl@DONOOOOOOM3NNOOOE@Z..''''''''''''''''''.'.=rlfdD0plxLytmOQB8PulzpgD6OOON89,gU===BV===;vL;=
BB;=@0OOOOOOOOOOOOOOO6BB=.r,''''''''''''.=.vGN00N3nlcmGjoIGeZpyVuKRBg3YYXOQQgBk,OK===BV===rx(cr
B*.v@ROOZddOOOOOOOOOOOB@l.Vr''''''''''''w);H|^===55IYiH9MIcK8MUzIhyvlMBQqx;rvx=,Mf===Bk===\(,kl
L..v@9OOx=,yNOOOOOOOOOg@D.I|'''''''''''.K0(p0P|===xymEenHD0Nux9QOmnyPmyr]K0DV=,,OV===BM====;x(=
-..yBNZx;.=lZOOOOOOOOO6B@;rM,'''''''''''.|Xsll0gs*===rVOeY(dBg8y]pdfjVlPmc^*yOdlQr;rxBp========
...RQOOOoYONNOOOOOOOOOOEBQ-,M-''''''''''''''=LYLc88a)===^YmZIvlOgQEVjZMUXxGqm;;8MyY*=@s=======*
;.;BgNOOOOONNOOOOOOOpOOOD@y.=x.'''''''''''''''.^=.rsB0o*====\I9BzYUPyVd3P3y6Q;>B-'''.pqV\=====i
^.l@ROOOOOOOOOOOOONd,^;kNQ@x.;_'''''''''''''''''''..-\eQRz*====rymGzQD5zvl@8*=ob.'''''.=YnVkv;n
..DB6OOOOOOOOOOOOOGc._,vGNBB,.'''''''''''''''''''''''''.=YM0dV*====Y3mkVQB]==\B;''''''''''.,VbM
.^@8OOOOOOOOOOOOOONh;adUPORBZ..''''''''''''''''''''''''''''-<VZZPx;==;xhw;===hB.''''''''''''_^V
;BQNOOOOOOOOOOOOOOONNONNNOO9Bv.''''''''''''''''''''''''''''''''',lHdl^=======Qj._''''''''''''''
0B9OOOOOOOOOOOOOOOOOOOOOOOOO80,'''''''''''''''''''''''''''''''''''.,wM3Z5wyzMV,K^''''''''''''''
@gNOOOOOOOOOOOOOOOOOOOOOOOOONB8.''''''''''''''''''''''''''''''''''''''.,vK9EM3Zx.''''''''''''''
gN6D8BBBBBQ09NNOOOOOOONDgQBBQB@,.'''''''''''''''''''''''''''''''''''''''''.--''''''''''''''''''
QB@@@@@@@@@@gQQg000gQBB@@@@@@p)(=''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Q@@@@@@@@Bm,'.,^\]v==lOQB@@@Q)w='''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
idQBBBg3\,'''''''''''''..,,,=lY.'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

 _____ _                          _      ___  ___            _        _    _                 _ 
/  ___| |                        ( )     |  \/  |           (_)      | |  | |               | |
\ ``--.| |__   __ ___      ___ __ |/ ___  | .  . | __ _  __ _ _  ___  | |  | | __ _ _ __   __| |
 ``--. \ '_ \ / _`` \ \ /\ / / '_ \  / __| | |\/| |/ _`` |/ _`` | |/ __| | |/\| |/ _`` | '_ \ / _`` |
/\__/ / | | | (_| |\ V  V /| | | | \__ \ | |  | | (_| | (_| | | (__  \  /\  / (_| | | | | (_| |
\____/|_| |_|\__,_| \_/\_/ |_| |_| |___/ \_|  |_/\__,_|\__, |_|\___|  \/  \/ \__,_|_| |_|\__,_|
                                                        __/ |                                  
                                                       |___/                                   
"@

Write-Host $Wizard -ForegroundColor Cyan
$voice = New-Object -ComObject Sapi.spvoice
$voice.rate = 3
Write-Host "Performing Location Check..." -ForegroundColor Yellow



###Function Definitions###

Function Do-Windows-Updates{
    $WinUpdateEC = 0
    $WinUpdateErrorData = ""
	Write-Host "Preparing Windows Updates" -ForegroundColor Cyan
    Try{
   	    Install-PackageProvider -Name NuGet -Force
   }Catch{
   "Unable to install NuGet. Make sure the suspect is connected to the internet and apply Windows Updates Manually"
   $WinUpdateEC = 1
   $WinUpdateErrorData = "Unable to install NuGet. Make sure the suspect is connected to the internet and apply Windows Updates Manually"
   }
	Set-PSRepository -Name 'PSGallery' -InstallationPolicy Trusted
    Try{
        Install-Module -Name PSWindowsUpdate -Force
    	Import-Module PSWindowsUpdate
    }Catch{
    "Unable to import PSWindowsUpdate Library. Ensure the suspect is connected to the internet and try applying the updates manually"
    $WinUpdateEC = 2
    $WinUpdateErrorData = "Unable to import PSWindowsUpdate Library. Ensure the suspect is connected to the internet and try applying the updates manually"
    }
    Try{
	Get-WindowsUpdate 
    Install-WindowsUpdate -AcceptAll -IgnoreReboot
    }Catch{
    "An unexpected error prevented windows updates from going through. Please attempt to manually install"
    $WinUpdateEC = 3
    $WinUpdateErrorData = $_
    }
    Add-Content $components "`nWinUpdateEC=$WinUpdateEC"
    Add-Content $components "`nWinUpdateErrorData=$WinUpdateErrorData"
    If(!($WinUpdateEC -eq 0)){
        Write-Warning "Magic Wand encountered an error while installing Windows Updates. Abandoning install attempt with error code $WinUpdateEC"
    }Else{
        Write-Host "Windows Updates Completed" -ForegroundColor Green
    
}
}

Function Do-App-Updates{
    Write-Host "Updating Applicable Apps" -ForegroundColor Cyan
    Write-Output y|winget upgrade -h --all
    Write-Host "App Updates completed" -ForegroundColor Green
}

Function Create-Restore-Point{
    $RestoreEC = 0
    $RestoreErrorData = ""
    Write-Host "Creating System Restore Point" -ForegroundColor Cyan
    Checkpoint-Computer -Description "Magic Wand Restore Point" -RestorePointType "MODIFY_SETTINGS" -WarningVariable wv -WarningAction SilentlyContinue -ErrorAction SilentlyContinue -ErrorVariable wv
    If ($wv -like "A new system restore point cannot be created because one has already been created within the past*"){
        Write-Warning "A new restore point was not created because one has been made in the past 24 hours. This is usually good enough and not a cause for worry"
        $RestoreEC = 1
        $RestoreErrorData = "A new restore point was not created because one has been made in the past 24 hours. This is usually good enough and not a cause for worry"
    }ElseIf($wv -like "*the service cannot be started because it is disabled or does not have enabled devices associated with it*"){
        Write-Warning "System Restore point is currently disabled. This is common on older PC's, or those that originally came in S mode. Magic Wand will attempt to enable it for you."
        Try{
            Enable-ComputerRestore -Drive "C:\"
            Checkpoint-Computer -Description "Magic Wand Restore Point" -RestorePointType "MODIFY_SETTINGS" -WarningVariable wv -WarningAction SilentlyContinue -ErrorAction SilentlyContinue -ErrorVariable wv
        }Catch{
            "Magic Wand was unable to activate Restore point. The suspect potentially does not have the technical capability to activate it."
            $RestoreEC =2
            $RestoreErrorData = "The suspect does not have Restore Point enabled, and Magic Wand was not able to activate it. The suspect may not support this feature."
        }

        }
        Add-Content $components "`nRestoreEC = $RestoreEC"
        Add-Content $components "`nRestoreErrorData = $RestoreErrorData"
    If(!($RestoreEC -eq 0)){
        Write-Warning "Magic Wand was unable to create a restore point. Proceeding without creating one. Error code $RestoreEC"
    }Else{
        Write-Host "System Restore Point Created" -ForegroundColor Green
}
}
Function Sad-Beeps{
    $SadSong = New-Object System.Media.SoundPlayer

    for (($i=0);$i -lt 4; $i++){
        If($i % 2 -eq 0){
        $SadSong.SoundLocation = "$env:windir\Media\Windows Error.wav"
        $SadSong.Play()
        Start-Sleep 1
        }Else{
        $SadSong.SoundLocation = "$env:windir\Media\Windows Exclamation.wav"
        $SadSong.Play()
        Start-Sleep 1
        }
    }
}

Function Happy-Beeps{
    $HappySong = New-Object System.Media.SoundPlayer
    $HappySong.SoundLocation = "$env:windir\Media\Ring10.wav"
    $HappySong.Play()
}

###Location Check##




If(!($PSCommandPath -eq "$env:USERPROFILE\Desktop\Shawns_Magic_Wand.ps1" -or $PSCommandPath -eq "$env:USERPROFILE\OneDrive\Desktop\Shawns_Magic_Wand.ps1")){
    Sad-Beeps
    Write-Host "Friend, the directions were simple. This only works if you put me on the desktop.Press ENTER to exit, put me in the right spot, and lets try this again" -ForegroundColor Red
    $voice.speak("Friend, the directions were simple. This only works if you put me on the desktop.Press ENTER to exit, put me in the right spot, and lets try this again")
    Read-Host
    Exit
}Else{
    Write-Host "Location on Desktop Verified" -ForegroundColor Green
}

###Creating Spell_Components###

Write-Host "Building Spell Component Template" -ForegroundColor Yellow
If(Test-Path -Path "$env:USERPROFILE\Desktop\Spell_Components"){
    Write-Warning "Spell Components folder already detected, attempting to reset and recreate"
    Remove-Item -Path "$env:USERPROFILE\Desktop\Spell_Components" -Recurse
}
New-Item "$env:USERPROFILE\Desktop\Spell_Components" -ItemType Directory
New-Item $env:USERPROFILE\Desktop\Spell_Components\components.txt -ItemType File
$components = "$env:USERPROFILE\Desktop\Spell_Components\components.txt"
Add-Content $components "Suspect_Name=$env:computername"
$Manufacturer = Get-CimInstance -ClassName Win32_ComputerSystem | Select-Object -Property Manufacturer
Add-Content $components "`nManufacturer=$Manufacturer"
$Model_Number = Get-CimInstance -ClassName Win32_ComputerSystem | Select-Object -Property Model
Add-Content $components "`nModel=$Model_Number"
$BIOS = Get-CimInstance -ClassName Win32_ComputerSystem | Select-Object -Property SystemType
Add-Content $components "`nBIOS=$BIOS"
$Start_Time = Get-Date
Add-Content $components "`nStart_Time=$Start_Time"
Write-Host "Spell Component Template Created Sucessfully" -ForegroundColor Green
##Spell Selection##
#1.NPS
#2.Tune Up

Write-Host "Thank you for using choosing my Magic Wand. Please select a spell from the options below: " -ForegroundColor Cyan
Write-Host "1 - NPS " -ForegroundColor Cyan
Write-Host "2- Tune Up " -ForegroundColor Cyan
$SpellSelection = Read-Host "Enter the number for the spell you want the wizard to cast "


Switch($SpellSelection){

1 {
###NPS TABLE OF CONTENTS###
#1.Install Google Chrome
#2.Install Adobe Reader
#3.Windows Updates
#4.Application Updates
#5.Create a Restore Point
Write-Host "You have chosen to cast NPS. The following actions will be performed: " -ForegroundColor Cyan
Write-Host "- Install Google Chrome" -ForegroundColor Cyan
Write-Host "- Install Adobe Reader" -ForegroundColor Cyan
Write-Host "- Windows Updates" -ForegroundColor Cyan
Write-Host "- Application Updates" -ForegroundColor Cyan
Write-Host "- Delete Recent Items" -ForegroundColor Cyan
Write-Host "- Remove PowerShell folder (to reset ExecutionPolicy)" -ForegroundColor Cyan
Write-Host "- Empty Recycle Bin" -ForegroundColor Cyan
Write-Host "- Self Deletion Script (Dispel Magic) will be made" -ForegroundColor Cyan
Write-Host "- System Reboot" -ForegroundColor Cyan
Write-Host "- Create a Restore Point" -ForegroundColor Cyan
$confirm = Read-Host "Are you sure you wish to proceed? (y/n)"

If (!($confirm -eq "y")){
    Write-Host "The magic has fizzled out. Press any key to exit and try again (cancelled)" -ForegroundColor Red
    Read-Host
    Exit
}Else{
    Write-Host "NPS confirmed. The wizard is beginning his ritual" -ForegroundColor Green
    Add-Content $components "`nSpellSelection=NPS"
}

#1.Install Google Chrome
Write-Host "Installing Google Chrome" -ForegroundColor Cyan
$ChromeEC = 0
$ChromeErrorData = ""
$Path = $env:TEMP
$Installer = "chrome_installer.exe"
try{
    Invoke-WebRequest "http://dl.google.com/chrome/install/375.126/chrome_installer.exe" -OutFile $Path\$Installer
    Start-Process -FilePath $Path\$Installer -Args "/silent /install" -Verb RunAs -Wait
    Remove-Item $Path\$Installer
    }catch  [System.Net.WebException],[System.IO.IOException]{
        "Unable to connect to Chrome's installer. Please make sure the suspect is connected to the internet and try again"
        $ChromeEC = 1
        $ChromeErrorData = "Unable to connect to Chrome's installer. Please make sure the suspect is connected to the internet and try again"
        }
    catch{
        "An unexpected error is preventing magic wand from installing Chrome."
        $ChromeEC = 2
        $ChromeErrorData = $_
        }Finally{
        Add-Content $components "`nChromeEC=$ChromeEC"
        Add-Content $components "`nChromeErrorData=$ChromeErrorData"
        }
If(!($ChromeEC -eq 0)){
    Write-Warning "Magic Wand was unable to install chrome automatically. Abandoning Chrome Installation with Error Code $ChromeEC"
    }Else{
    Write-Host "Google Chrome Installed" -ForegroundColor Green
    }

#2.Install Adobe Reader
Write-Host "Installing Adobe Reader" -ForegroundColor Cyan
$AdobeEC = 0
$AdobeErrorData = ""
Try{
    winget install -e --id Adobe.Acrobat.Reader.64-bit #HUGE Shoutout to winget for making this easy with one line. RIP to the week and a half I spent trying to figure to ftp into Adobe's servers to download the file
    }Catch{
    "An unkown error has prevented Magic Wand from installing Adobe Reader."
    $AdobeEC = 1
    $AdobeErrorData = $_
    }Finally{
    Add-Content $components "`nAdobeEC=$AdobeEC"
    Add-Content $components "`nAdobeErrorData=$AdobeErrorData"
    }

If(!($AdobeEC -eq 0)){
    Write-Warning "Magic Wand was unable to install Adobe Reader automatically. Abandoning Installation with Error Code $AdobeEC"
    }Else{
    Write-Host "Adobe Reader Installed" -ForegroundColor Green
    }

#3.Windows Updates

Do-Windows-Updates

#4.Application Updates

Do-App-Updates

#5.Create Restore Point

Create-Restore-Point

Write-Host "Basic NPS complete" -ForegroundColor Green
Break
}#1 (NPS)
2 {
###TUNE UP TABLE OF CONTENTS###
#1.Create A Restore Point
#2.Chkdsk On Next Boot
#3.DISM
#4.SFC
#5.Delete User Temp files
#6.Delete Windows Temp files
#7.Disk Cleanup
#8.Optimize Drive
#9.Windows Updates
#10.App Updates

Write-Host "You have chosen to cast Tune Up. The following actions will be performed: " -ForegroundColor Cyan
Write-Host "- Create a Restore Point" -ForegroundColor Cyan
Write-Host "- chkdsk enabled on next reboot" -ForegroundColor Cyan
Write-Host "- DISM" -ForegroundColor Cyan
Write-Host "- SFC" -ForegroundColor Cyan
Write-Host "- Delete User Tmp Files" -ForegroundColor Cyan
Write-Host "- Delete Operating System Tmp Files" -ForegroundColor Cyan
Write-Host "- Disk Cleanup" -ForegroundColor Cyan
Write-Host "- Drive Optimization" -ForegroundColor Cyan
Write-Host "- Windows Updates" -ForegroundColor Cyan
Write-Host "- App Updates" -ForegroundColor Cyan
Write-Host "- Delete Recent Items" -ForegroundColor Cyan
Write-Host "- Remove PowerShell folder (to reset ExecutionPolicy)" -ForegroundColor Cyan
Write-Host "- Empty Recycle Bin" -ForegroundColor Cyan
Write-Host "- Self Deletion Script (Dispel Magic) will be made" -ForegroundColor Cyan
Write-Host "- System Reboot" -ForegroundColor Cyan
$confirm = Read-Host "Are you sure you wish to proceed? (y/n)"

If (!($confirm -eq "y")){
    Write-Host "The magic has fizzled out. Press any key to exit and try again (cancelled)" -ForegroundColor Red
    Read-Host
    Exit
}Else{
    Write-Host "Tune Up confirmed. The wizard is beginning his ritual" -ForegroundColor Green
    Add-Content $components "`nSpellSelection=Tune-Up"
}

#1.Creating a Restore Point 
    Create-Restore-Point

#2.Chkdsk On Next Boot
    Write-Host "Enabling chkdsk on next boot" -ForegroundColor Cyan
    Write-Output y|chkdsk c: /x /f /r
    Write-Host "chkdsk will be completed next reboot" -ForegroundColor Green

#3.DISM
	Write-Host "Starting DISM" -ForegroundColor Cyan
    Write-Warning "DISM and SFC can both take a long time to run. Magic Wand is still running. Clicking the red square should break the script if it appears to be unresponsive for a long (over 3 hours) time"
    Start-Process -FilePath "dism.exe" -ArgumentList '/online /cleanup-image /startcomponentcleanup' -Wait
    Write-Host "DISM 50% complete" -ForegroundColor Yellow
    Start-Process -FilePath "dism.exe" -ArgumentList '/online /cleanup-image /restorehealth' -Wait 
    Write-Host "DISM completed" -ForegroundColor Green

#4.SFC
    Write-Host "Starting SFC" -ForegroundColor Yellow
    Start-Process -FilePath "sfc.exe" -ArgumentList '/scannow' -Wait  
   	Write-Host "SFC completed" -ForegroundColor Green

#5.Delete User Temp files   
	$temp = get-ChildItem "env:\TEMP"   
	$temp2 = $temp.Value 
    Write-Host "Deleting User Temp files" -ForegroundColor Yellow    
    Remove-Item -Recurse  "$temp2\*" -Force -ErrorAction SilentlyContinue
    Write-Host "Temporary User files deleted sucessfully" -ForegroundColor Green 
           
#6.Delete Windows Temp files    
	$WinTemp = "c:\Windows\Temp\*" 
    Write-Host "Deleting Windows Temp files" -ForegroundColor Yellow   
    Remove-Item -Recurse $WinTemp -Force -ErrorAction SilentlyContinue
    Write-Host "Temporary Windows files deleted sucessfully" -ForegroundColor Green 
      
#7.Disk Cleanup    
    Write-Host "Starting Disk Cleanup" -ForegroundColor Yellow   
    cleanmgr /sagerun:1 | out-Null  
    Start-Sleep 2            
    Write-Host "Disk Cleanup completed" -ForegroundColor Green

#8.Optimize Drive
	Write-Host "Starting Drive Optimization" -ForegroundColor Yellow
	Optimize-Volume -DriveLetter C 
	Write-Host "Drive Optimization Complete" -ForegroundColor Green

#9.Windows Updates
    Do-Windows-Updates

#10.App Updates
	Do-App-Updates


Break
}#2 (Tune Up)
Default {
Write-Host "A number my child. All you had to do was pick a number. Now I'm broken. Press any key to exit and try again. And let's get it right this time" -ForegroundColor Red
$voice.Speak("A number my child. All you had to do was pick a number. Now I'm broken. Press any key to exit and try again. And let's get it right this time")
Read-Host
Exit
}
}#Switch

#ENDGAME TABLE OF CONTENTS##
#1.Clear Recent Items
#2.Remove WindowsPowerShell Folder
#3.Empty Recycle Bin
#4.Create Delete (Dispel Magic) Script
#5.Restart

#1.Clear Recent Items
	Write-Host "Clearing Recent Items" -ForegroundColor Yellow
	Get-ChildItem $env:appdata\Microsoft\Windows\Recent\* -Recurse | Remove-Item -Force -Recurse
	Write-Host "Clearing Recent Items completed" -ForegroundColor Green
#2.Remove WindowsPowerShell Folder
	Write-Host "Removing WindowsPowerShell folder" -ForegroundColor Yellow
	if (Test-Path "$env:userprofile\Documents\WindowsPowerShell") {
  	Remove-Item $env:userprofile\Documents\WindowsPowerShell -Recurse
	}
	Write-Host "Removing WindowsPowerShell folder completed" -ForegroundColor Green

#3.Empty Recycle Bin
	Write-Host "Emptying Recycle Bin" -ForegroundColor Yellow
	Clear-RecycleBin -Force -ErrorAction SilentlyContinue
	Write-Host "Emptying Recycle Bin completed" -ForegroundColor Green

#4.Create Delete (Dispel Magic) Script
    $StartupPath = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"

    $DelScript = "Dispel_Magic.ps1"

    $DelBatch = "Dispel_Magic.bat"

    

    $BatchContents = @"
    @echo OFF
    PowerShell.exe -NoProfile -Command "& {Start-Process PowerShell.exe -ArgumentList '-NoProfile -ExecutionPolicy Bypass -File ""$env:USERPROFILE\Desktop\Dispel_Magic.ps1""' -Verb RunAs}"
    

"@
    $ScriptContents = @"

    Write-Host "The Wizard has finished casting his spell. Preparing Dispel Magic to Delete" -ForegroundColor Green

    `$WandPath = "$PSCommandPath"
    `$DispelBatchPath = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\Dispel_Magic.bat"
    `$CompPath = "$env:USERPROFILE\Desktop\Spell_Components"

    `$HasErrorWand = `$True
    `$HasErrorBatch = `$True
    `$HasErrorComp = `$True

    If (Test-Path `$WandPath){
        Write-Host "Found Magic Wand on Desktop - Attempting to Delete" -ForegroundColor Cyan
        Remove-Item -Path `$WandPath
        If (!(Test-Path `$WandPath)){
            Write-Host "Magic Wand Sucessfully Deleted" -ForegroundColor Green
            `$HasErrorWand = `$False
        }Else{
            Write-Host "FATAL ERROR: Magic Wand was unable to be automatically uninstalled. Please manually dispel." -ForegroundColor Red
            
        }
    }Else{
        Write-Host "FATAL ERROR: Magic Wand was unable to be automatically uninstalled because it was not able to be located on the Desktop. Please double check and manually dispel." -ForegroundColor Red -BackgroundColor Yellow
       
    }


    If (Test-Path `$DispelBatchPath){
        Write-Host "Found Dispel Magic's Ritual in Startup - Attempting to Delete" -ForegroundColor Cyan
        Remove-Item -Path `$DispelBatchPath
        If (!(Test-Path `$DispelBatchPath)){
            Write-Host "Dispel Magic's Ritual Sucessfully Deleted" -ForegroundColor Green
            `$HasErrorBatch = `$False
        }Else{
            Write-Host "FATAL ERROR: Dispel Magic's ritual (batch file) was unable to be automatically uninstalled. Location: C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\Dispel_Magic.bat." -ForegroundColor Red -BackgroundColor Yellow
            
        }
    }Else{
        Write-Host "FATAL ERROR: Dispel Magic's ritual (batch file) was unable to be automatically uninstalled because it was not able to be located in the Startup folder. Please find and delete it." -ForegroundColor Red -BackgroundColor Yellow
        
    }

    If (Test-Path `$CompPath){
        Write-Host "Found Spell Components on Desktop - Attempting to Delete" -ForegroundColor Cyan
        Remove-Item -Path `$CompPath -Recurse
        If (!(Test-Path `$DispelBatchPath)){
            Write-Host "Spell Components Sucessfully Deleted" -ForegroundColor Green
            `$HasErrorComp = `$False
        }Else{
            Write-Host "FATAL ERROR: Spell Components were unable to be automatically uninstalled from the Desktop. Please Manually Remove." -ForegroundColor Red 
            
        }
    }Else{
        Write-Host "FATAL ERROR: Spell Components were not able to be located on the desktop. Please find and delete them." -ForegroundColor Red
        
    }



    If ((Test-Path `$PSCommandPath) -and (`$HasErrorWand -eq `$False) -and (`$HasErrorBatch -eq `$False) -and (`$HasErrorComp -eq `$False)){
        Write-Host "Thank you for using Shawn's Magic Wand. Please press ENTER and Dispel Magic will dispel itself" -ForegroundColor Cyan
        Read-Host
        Remove-Item -Path `$PSCommandPath
        Exit

    }Else{
        Write-Host "Dispel Magic was unable to properly remove one or more elements of Shawn's Magic Wand. Please refrence the above errors and manually delete them, and then this program. Press any key to exit" -ForegroundColor Red
        Read-Host
        Exit}
"@

If (!(Test-Path $StartupPath\Dispel_Magic.bat)){
    New-Item -Path $env:USERPROFILE\Desktop -name $DelScript -Type "file" -Value $ScriptContents
    New-Item -Path $StartupPath -name $DelBatch -Type "file" -Value $BatchContents
    Write-Host "Created Dispel Magic"
}Else{
    Write-Host "ERROR: Dispel Magic already exists apparently. Something broke. Please Manually Investigate Desktop and Startup folder" -ForegroundColor Red
}

#5.Restart
    Happy-Beeps
    $wshell = New-Object -ComObject Wscript.Shell
    $wshell.Popup("The wizard has completed his ritual. The unit will be rebooted in 30 seconds. When the system reboots and you log in, be sure to hit YES on the UAC prompt to launch Dispel Magic",30,"Ritual Complete",0x0)
    shutdown /r /t 0
